<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokedex Interactiva - Aleatoria</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #333;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            /* >>> CAMBIO CLAVE: Permite scroll en pantallas pequeñas <<< */
            overflow-y: auto; 
            /* Para centrar el contenido verticalmente si es más pequeño que la pantalla */
            padding-top: 20px;
            padding-bottom: 20px;
        }

        .pokedex-frame {
            width: 700px; 
            height: 900px;
            background-color: #DA2A2A; 
            border: 15px solid #333; 
            border-radius: 25px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
            position: relative;
            display: flex;
            flex-direction: column;
            /* Permite que el frame se desborde si el contenido es demasiado alto en el móvil */
            min-height: 800px; 
            overflow: hidden;
        }

        /* Barra superior */
        .top-bar {
            height: 80px;
            background-color: #333;
            display: flex;
            align-items: center;
            padding: 0 20px;
            border-bottom: 5px solid #1a1a1a;
            box-shadow: inset 0 -3px 5px rgba(0, 0, 0, 0.3);
        }
        .blue-light {
            width: 50px;
            height: 50px;
            background-color: #00BFFF; 
            border-radius: 50%;
            border: 3px solid #87CEEB;
            box-shadow: 0 0 15px #00BFFF, inset 0 0 8px rgba(255, 255, 255, 0.7);
        }
        .red-lights {
            display: flex;
            gap: 10px;
            margin-left: 20px;
        }
        .light {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid rgba(0, 0, 0, 0.5);
        }
        .light.red { background-color: #FF6B6B; }
        .light.yellow { background-color: #FFD966; }
        .light.green { background-color: #6BFFB6; }

        /* Pantalla principal */
        .main-screen {
            background-color: #EFEFEF; 
            border: 8px solid #333;
            border-radius: 10px;
            margin: 20px;
            flex-grow: 1; 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 15px;
            padding: 15px;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.5);
            color: #333; 
            overflow: hidden; 
        }

        /* Área de Display del Pokémon (Izquierda) */
        .pokemon-display-area {
            background-color: transparent; 
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3); 
            position: relative;
            overflow: hidden; 
        }

        /* Contenedor para el Degradado Dinámico (Fondo) */
        .pokemon-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 8px;
            background: radial-gradient(circle, #f0f0f0 40%, #e0e0e0 100%);
            z-index: 1;
            transition: background 1s ease-out; /* Transición para el degradado */
        }

        .pokemon-img {
            width: 180px;
            height: 180px;
            object-fit: contain;
            margin-bottom: 10px;
            z-index: 2; 
        }
        .pokemon-details {
            text-align: center;
            z-index: 2; 
            color: black; 
        }
        #nombre {
            font-size: 1.8em;
            margin: 0 0 5px 0;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5);
        }
        #numero {
            font-size: 1.1em;
            margin: 0;
            color: #555;
        }
        
        /* Tipos de Pokémon */
        .types-list {
            list-style: none;
            padding: 0;
            margin: 10px 0 0 0;
            display: flex;
            gap: 8px;
            justify-content: center;
        }
        .types-list li {
            padding: 4px 10px;
            border-radius: 5px;
            color: white; 
            font-size: 0.85em;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.3);
        }

        /* Panel de Stats y Habilidades (Derecha) */
        .stats-info-panel {
            background-color: #F8F8F8;
            border-radius: 8px;
            padding: 15px;
            overflow-y: auto;
            box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.2);
            color: #333;
        }
        .section-title {
            color: #DA2A2A; 
            margin-top: 15px;
            margin-bottom: 8px;
            border-bottom: 1px solid #CCC;
            padding-bottom: 5px;
        }
        .stats-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .stats-list li {
            margin-bottom: 10px;
            font-size: 0.9em;
            display: flex;
            flex-direction: column;
        }
        .progress-bar-container {
            width: 100%;
            background-color: #DDD;
            border-radius: 5px;
            height: 10px;
            overflow: hidden;
            margin-top: 3px;
        }
        .progress-bar-fill {
            height: 100%;
            background-color: #4CAF50;
            border-radius: 5px;
            transition: width 0.8s ease-out; 
        }
        .type-relations-list {
            list-style: none;
            padding: 0;
            margin: 5px 0 15px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        .type-relations-list li {
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            font-weight: bold;
        }

        /* Panel Inferior */
        .bottom-panel {
            background-color: #333;
            padding: 20px;
            border-top: 5px solid #1a1a1a;
            grid-template-columns: 1.5fr 1fr; 
            gap: 30px; 
            display: grid;
            align-items: center;
            box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.3);
        }
        
        .description-screen {
            background-color: #62B839;
            border: 4px solid #3A7320;
            border-radius: 8px;
            padding: 10px;
            height: 120px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            font-family: 'Press Start 2P', cursive;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        .screen-header {
            display: flex;
            justify-content: space-between;
            padding-bottom: 5px;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.5);
            margin-bottom: 5px;
            font-size: 0.7em;
        }
        .screen-content {
            flex-grow: 1;
            overflow-y: auto;
            font-size: 0.8em;
        }
        #description-text {
            margin: 0;
            line-height: 1.4;
        }

        .controls-section {
            display: flex;
            align-items: center;
            justify-content: space-around;
        }
        .d-pad {
            width: 80px;
            height: 80px;
            background-color: #555;
            border-radius: 10px;
            position: relative;
        }
        .d-pad-center, .d-pad-up, .d-pad-down, .d-pad-left, .d-pad-right {
            background-color: #444;
            position: absolute;
            border-radius: 3px;
        }
        .d-pad-center { width: 30px; height: 30px; top: 25px; left: 25px; }
        .d-pad-up, .d-pad-down { width: 30px; height: 25px; left: 25px; }
        .d-pad-up { top: 0; }
        .d-pad-down { bottom: 0; }
        .d-pad-left, .d-pad-right { width: 25px; height: 30px; top: 25px; }
        .d-pad-left { left: 0; }
        .d-pad-right { right: 0; }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .action-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 3px solid #333;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
            cursor: pointer;
        }
        .action-btn.red-btn { background-color: #FF5C5C; }
        .action-btn.green-btn { background-color: #6BFF6B; }

        /* Pokeball interactiva */
        .pokeball-interactive {
            position: absolute;
            top: 75px;
            right: 20px;
            width: 80px;
            height: 80px;
            cursor: pointer;
            z-index: 10;
            filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.5));
            transition: transform 0.2s ease;
        }
        .pokeball-interactive:hover {
            transform: scale(1.1) rotate(15deg);
        }
        .pokeball-icon {
            width: 100%;
            height: 100%;
        }
        
        /* Responsive básico */
        @media (max-width: 800px) {
            .pokedex-frame {
                /* Se cambia de altura fija a una altura basada en el contenido */
                height: auto; 
                width: 95%;
                border-radius: 15px;
                border-width: 10px;
                /* El frame no tiene overflow:hidden para que el content panel se vea bien */
            }
            .main-screen {
                grid-template-columns: 1fr; 
                gap: 10px;
                margin: 10px;
                padding: 10px;
            }
            .pokemon-img {
                width: 150px;
                height: 150px;
            }
            .pokeball-interactive {
                top: 15px;
                right: 15px;
                width: 60px;
                height: 60px;
            }

            /* Se asegura que el panel de información pueda crecer */
            .stats-info-panel {
                overflow-y: visible; /* Elimina scroll interno y permite que el contenedor crezca */
                height: auto;
            }
        }
    </style>
</head>
<body>

    <div class="pokedex-frame">
        <div class="top-bar">
            <div class="blue-light"></div>
            <div class="red-lights">
                <div class="light red"></div>
                <div class="light yellow"></div>
                <div class="light green"></div>
            </div>
        </div>

        <div class="main-screen">
            
            <div class="pokemon-display-area">
                <div id="pokemon-background" class="pokemon-background"></div>
                <img id="img" class="pokemon-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Imagen del Pokémon">
                
                <div class="pokemon-details">
                    <h2 id="nombre">Cargando...</h2>
                    <h3 id="numero"></h3>
                    <ul id="tipos-display" class="types-list"></ul>
                </div>
            </div>
            
            <div class="stats-info-panel">
                <h4 class="section-title">Estadísticas Base:</h4>
                <ul id="stats" class="stats-list"></ul>
                
                <h4 class="section-title">Detalles:</h4>
                <p><strong>Altura:</strong> <span id="altura"></span> m</p>
                <p><strong>Peso:</strong> <span id="peso"></span> kg</p>

                <h4 class="section-title">Habilidades:</h4>
                <ul id="abilities" class="type-relations-list"></ul>

                <h4 class="section-title">Ventajas y Desventajas:</h4>
                <p><strong>Super efectivo contra:</strong></p>
                <ul id="super" class="type-relations-list"></ul>

                <p><strong>Débil contra:</strong></p>
                <ul id="debil" class="type-relations-list"></ul>
            </div>
        </div>

        <div class="bottom-panel">
            
            <div class="description-screen">
                <div class="screen-header">
                    <span class="screen-title">POKÉMON NAME</span>
                    <span class="screen-title">TYPE(s)</span>
                </div>
                <div class="screen-content">
                    <p id="description-text">Cargando...</p>
                </div>
            </div>

            <div class="controls-section">
                <div class="d-pad">
                    <div class="d-pad-center"></div>
                    <div class="d-pad-up"></div>
                    <div class="d-pad-down"></div>
                    <div class="d-pad-left"></div>
                    <div class="d-pad-right"></div>
                </div>
                <div class="action-buttons">
                    <button class="action-btn red-btn"></button>
                    <button class="action-btn green-btn"></button>
                </div>
            </div>
        </div>

        <div class="pokeball-interactive" onclick="traerPokemonAleatorio()">
            <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Pok%C3%A9_Ball_icon.svg" alt="Pokeball" class="pokeball-icon">
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        const capitalize = (s) => s.charAt(0).toUpperCase() + s.slice(1);

        const typeColors = {
            normal: '#A8A77A', fire: '#EE8130', water: '#6390F0', electric: '#F7D02C',
            grass: '#7AC74C', ice: '#96D9D6', fighting: '#C22E28', poison: '#A33EA1',
            ground: '#E2BF65', flying: '#A98FF3', psychic: '#F95587', bug: '#A6B91A',
            rock: '#B6A136', ghost: '#735797', dragon: '#6F35FC', steel: '#B7B7CE',
            fairy: '#D685AD', dark: '#705746'
        };

        const MAX_POKEMON_ID = 1025; 

        // FUNCIÓN CLAVE CORREGIDA: Aplica el degradado estilo "poster" usando los colores de los TIPOS del Pokémon.
        function aplicarDegradado(pokemonTypes) {
            const backgroundDiv = document.getElementById("pokemon-background");
            
            // 1. Obtener los códigos de color
            const colors = pokemonTypes
                .map(type => typeColors[type.toLowerCase()])
                .filter(color => color); 
            
            const fallbackColor = '#e0e0e0';

            if (colors.length === 0) {
                backgroundDiv.style.background = `radial-gradient(circle at 50% 50%, #fff 10%, ${fallbackColor} 100%)`;
                return;
            }

            const color1 = colors[0];
            const color2 = colors.length > 1 ? colors[1] : color1; 

            // 2. Lógica del degradado ajustada para priorizar los colores de los tipos
            
            if (colors.length === 1) {
                 // Un solo tipo: Degradado radial que empieza CLARO en el centro y pasa al color de tipo.
                 backgroundDiv.style.background = `
                    radial-gradient(
                        circle at 50% 50%, 
                        #ffffff 5%,
                        ${color1} 40%, 
                        #a0a0a0 100%
                    )`;
            } else {
                 // Dos tipos (ej. Sandygast: Ghost/Ground): Usa una mezcla de ambos colores.
                 // Se usa un degradado cónico para una mezcla más tridimensional y un sutil radial claro en el centro.
                 
                 // Degradado cónico que combina ambos colores de tipo fuertemente
                 const conicPart = `conic-gradient(from 0deg at 50% 50%, ${color1} 0deg, ${color2} 120deg, ${color1} 240deg, ${color2} 360deg)`;
                 
                 // Radial CLARO en el centro para el foco, sobre la mezcla de colores
                 const radialLight = `radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.5) 10%, transparent 40%)`;

                 // Se apilan los fondos: la luz radial sobre la mezcla cónica
                 backgroundDiv.style.background = `${radialLight}, ${conicPart}`;
            }
        }


        async function traer(pokemonInput) {
            
            // 1. Resetear la UI para el estado de carga/error
            document.getElementById("pokemon-background").style.background = 'white';
            document.getElementById("img").src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";
            document.getElementById("nombre").textContent = "Cargando...";
            document.getElementById("numero").textContent = "";
            document.getElementById("tipos-display").innerHTML = "";
            document.getElementById("altura").textContent = "";
            document.getElementById("peso").textContent = "";
            document.getElementById("stats").innerHTML = "";
            document.getElementById("abilities").innerHTML = ""; 
            document.getElementById("super").innerHTML = "";
            document.getElementById("debil").innerHTML = "";
            document.getElementById("description-text").textContent = "Buscando descripción...";

            try {
                // Petición del Pokémon principal
                let res = await axios.get(`https://pokeapi.co/api/v2/pokemon/${pokemonInput}`);
                let data = res.data;

                // --- Procesamiento de Especies/Descripción (Aislado) ---
                let description = "Descripción no disponible.";
                try {
                    let speciesRes = await axios.get(data.species.url);
                    let speciesData = speciesRes.data;
                    let entry = speciesData.flavor_text_entries.find(entry => entry.language.name === 'es');
                    if (entry) {
                        description = entry.flavor_text.replace(/[\n\f]/g, ' ');
                    }
                } catch (e) {
                    // Ignorar errores de descripción
                }
                
                // --- Actualizar la UI ---
                
                document.getElementById("img").src = data.sprites.other["official-artwork"]["front_default"] || data.sprites.front_default;
                document.getElementById("nombre").textContent = capitalize(data.name);
                document.getElementById("numero").textContent = "#" + data.id;

                // Tipos y obtención de tipos para el degradado
                let tiposDisplayUL = document.getElementById("tipos-display");
                const currentPokemonTypes = []; 
                data.types.forEach(t => {
                    let li = document.createElement("li");
                    let typeName = capitalize(t.type.name);
                    li.textContent = typeName;
                    li.style.backgroundColor = typeColors[t.type.name] || '#68A090';
                    tiposDisplayUL.appendChild(li);
                    currentPokemonTypes.push(t.type.name); 
                });

                aplicarDegradado(currentPokemonTypes);


                // Altura y Peso
                document.getElementById("altura").textContent = (data.height / 10).toFixed(1);
                document.getElementById("peso").textContent = (data.weight / 10).toFixed(1);

                // Estadísticas
                let statsUL = document.getElementById("stats");
                const maxStatValue = 255;
                data.stats.forEach(s => {
                    let li = document.createElement("li");
                    let statName = capitalize(s.stat.name.replace('-', ' '));
                    let statValue = s.base_stat;
                    
                    let progressBarContainer = document.createElement("div");
                    progressBarContainer.className = "progress-bar-container";
                    
                    let progressBarFill = document.createElement("div");
                    progressBarFill.className = "progress-bar-fill";
                    let percentage = (statValue / maxStatValue) * 100;
                    progressBarFill.style.width = `${percentage}%`;

                    let statText = document.createElement("span");
                    statText.textContent = `${statName}: ${statValue}`;
                    
                    li.appendChild(statText);
                    li.appendChild(progressBarContainer);
                    progressBarContainer.appendChild(progressBarFill);
                    statsUL.appendChild(li);
                });
                
                // Habilidades
                let abilitiesUL = document.getElementById("abilities");
                data.abilities.forEach(a => {
                    let li = document.createElement("li");
                    let abilityName = capitalize(a.ability.name.replace('-', ' ')); 
                    li.textContent = abilityName;
                    if (a.is_hidden) {
                        li.title = "Habilidad oculta";
                        li.style.border = "2px dashed #DA2A2A"; 
                    }
                    abilitiesUL.appendChild(li);
                });


                // Ventajas y desventajas
                let tipoPrincipal = data.types[0].type.name;
                let tipoDataRes = await axios.get(`https://pokeapi.co/api/v2/type/${tipoPrincipal}`);
                let tipoData = tipoDataRes.data;

                // Super efectivo contra
                let superUL = document.getElementById("super");
                superUL.innerHTML = "";
                if (tipoData.damage_relations.double_damage_to.length === 0) {
                    superUL.innerHTML = "<li>Ninguno</li>";
                } else {
                    for (let x of tipoData.damage_relations.double_damage_to) {
                        let li = document.createElement("li");
                        li.textContent = capitalize(x.name);
                        li.style.backgroundColor = typeColors[x.name] || '#FF5733';
                        superUL.appendChild(li);
                    }
                }
                
                // Débil contra
                let debilUL = document.getElementById("debil");
                debilUL.innerHTML = "";
                if (tipoData.damage_relations.double_damage_from.length === 0) {
                    debilUL.innerHTML = "<li>Ninguno</li>";
                } else {
                    for (let x of tipoData.damage_relations.double_damage_from) {
                        let li = document.createElement("li");
                        li.textContent = capitalize(x.name);
                        li.style.backgroundColor = typeColors[x.name] || '#999';
                        debilUL.appendChild(li);
                    }
                }

                document.getElementById("description-text").textContent = description;

            } catch (error) {
                console.error("Error al buscar el Pokémon:", error);
                
                document.getElementById("pokemon-background").style.background = 'radial-gradient(circle, #f0f0f0 40%, #e0e0e0 100%)';
                document.getElementById("nombre").textContent = "¡ERROR!";
                document.getElementById("description-text").textContent = "No se pudo cargar. Intenta de nuevo con la Pokeball.";
            }
        }

        async function traerPokemonAleatorio() {
            const randomId = Math.floor(Math.random() * MAX_POKEMON_ID) + 1;
            await traer(randomId);
        }

        document.addEventListener("DOMContentLoaded", () => {
            traerPokemonAleatorio();
        });

    </script>
</body>
</html>